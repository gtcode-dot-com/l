{{ define "main" }}
  <!-- Breadcrumb -->
  <nav class="breadcrumb">
    <a href="/">Home</a>
    <span class="breadcrumb-separator">&rsaquo;</span>
    <strong>{{ humanize .Title }}</strong>
  </nav>

  <!-- Section Header -->
  <div class="section-header">
    <h1 class="section-title">{{ humanize .Title }}</h1>
    <p class="section-description">All articles tagged with {{ .Title }}.</p>
  </div>

  <!-- Articles List -->
  {{ if .Pages }}
    {{/* Language filter bar for taxonomy pages */}}
    {{ $langScratch := newScratch }}
    {{ $langScratch.Set "langsCSV" "" }}
    {{ range .Pages }}
      {{ with .Params.language }}
        {{ $langScratch.Add "langsCSV" (printf "%s," (lower .)) }}
      {{ end }}
    {{ end }}
    {{ $langs := slice }}
    {{ $langsCSV := $langScratch.Get "langsCSV" | default "" }}
    {{ if gt (len $langsCSV) 0 }}
      {{ $trimmed := trim $langsCSV "," }}
      {{ $langs = uniq (sort (split $trimmed ",")) }}
    {{ end }}
    {{/* Language selector removed: we now filter server-side */}}
    <div class="news-list news-list-grid">
      {{ range .Pages.ByDate.Reverse }}
        <article class="card news-list-item" data-lang="{{ with .Params.language }}{{ . | lower }}{{ end }}">
          {{ if or .Params.category .Params.language }}
            <div class="card-meta" style="display:flex; gap:0.5rem; align-items:center; flex-wrap:wrap;">
              {{ with .Params.category }}
                <span class="badge badge-category">{{ . }}</span>
              {{ end }}
              {{ partial "language-badge.html" . }}
            </div>
          {{ end }}

          <h2 class="card-title">
            <a href="{{ .RelPermalink }}">{{ .Title }}</a>
          </h2>

          <div class="card-meta">
            {{ partial "news-date.html" . }}
          </div>

          {{ with .Summary }}
            {{ $clean := replace (replace . "" "") "" "" }}
            <p class="card-summary">{{ $clean | plainify | truncate 200 }}</p>
          {{ end }}

          <a class="btn btn-link" href="{{ .RelPermalink }}">Read article â†’</a>
        </article>
      {{ end }}
    </div>
  {{ else }}
    <div class="card">
      <p class="text-muted">No articles found with this tag.</p>
    </div>
  {{ end }}
{{ end }}
