<!-- layouts/partials/repos-menu-recursive.html -->
{{ $context := .context }}
{{ $currentPage := .currentPage }}

<!-- Render Pages in the current section -->
{{ range $context.Pages.ByTitle }}
    <a href="{{ .RelPermalink }}" class="repo-menu-item {{ if eq . $currentPage }}active{{ end }}">
        {{ .Title }}
    </a>
{{ end }}

<!-- Render Subsections (Folders) -->
{{ range $context.Sections.ByTitle }}
    <div class="repo-submenu">
        <details class="repo-submenu-accordion" {{ if $currentPage.IsDescendant . }}open{{ end }}>
            <summary class="repo-submenu-summary">{{ .Title }}</summary>
            <div class="repo-submenu-content">
                <!-- Recursive call for sub-folders -->
                {{ partial "repos-menu-recursive.html" (dict "context" . "currentPage" $currentPage) }}
            </div>
        </details>
    </div>
{{ end }}
