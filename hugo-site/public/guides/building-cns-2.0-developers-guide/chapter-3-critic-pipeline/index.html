<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><title>Chapter 3: Multi-Component Critic Pipeline | Building CNS 2.0: A Developer's Guide</title><meta name=description content="Implementing transparent evaluation systems for grounding, logic, and novelty assessment"><meta name=author content="CNS Development Team"><link rel=icon type=image/svg+xml href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üß†</text></svg>"><link rel=stylesheet href="/css/style.css?v=1753840877"><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel=stylesheet><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css><script src=https://unpkg.com/feather-icons></script></head><body><div class=site-wrapper><header class=site-header><div class=container><nav class=main-nav><div class=nav-brand><a href=/guides/building-cns-2.0-developers-guide/ class=brand-link><span class=brand-icon>üß†</span>
<span class=brand-text>Building CNS 2.0: A Developer's Guide</span></a></div><div class=nav-menu><button class=nav-toggle id=nav-toggle aria-label="Toggle navigation">
<i data-feather=menu></i></button><ul class=nav-list><li class=nav-item><a href=/guides/building-cns-2.0-developers-guide/chapter-1-introduction/ class=nav-link>Introduction</a></li><li class=nav-item><a href=/guides/building-cns-2.0-developers-guide/chapter-2-sno-foundations/ class=nav-link>SNO Foundations</a></li><li class=nav-item><a href=/guides/building-cns-2.0-developers-guide/chapter-3-critic-pipeline/ class=nav-link>Critic Pipeline</a></li><li class=nav-item><a href=/guides/building-cns-2.0-developers-guide/chapter-4-synthesis-engine/ class=nav-link>Synthesis Engine</a></li><li class=nav-item><a href=/guides/building-cns-2.0-developers-guide/chapter-5-system-integration/ class=nav-link>System Integration</a></li><li class=nav-item><a href=/guides/building-cns-2.0-developers-guide/chapter-6-complete-implementation/ class=nav-link>Complete Implementation</a></li></ul></div></nav></div></header><main class=site-main><div class=container><article class=content-article><header class=article-header><div class=article-meta><span class=article-weight>Chapter 3</span>
<span class=article-separator>‚Ä¢</span>
<time class=article-date>July 29, 2025</time></div><h1 class=article-title>Chapter 3: Multi-Component Critic Pipeline</h1><p class=article-description>Implementing transparent evaluation systems for grounding, logic, and novelty assessment</p><div class=progress-indicator><div class=progress-bar><div class=progress-fill style=width:50.010000000000005%></div></div><span class=progress-text>3/6 chapters completed</span></div></header><aside class=article-toc><h3>Table of Contents</h3><nav id=TableOfContents><nav id=TableOfContents><ul><li><a href=#the-problem-with-black-box-evaluation>The Problem with Black-Box Evaluation</a><ul><li><a href=#from-paper-to-code-the-mathematical-foundation>From Paper to Code: The Mathematical Foundation</a></li></ul></li><li><a href=#implementing-the-specialized-critics>Implementing the Specialized Critics</a><ul><li><a href=#2-logic-critic-implementation>2. Logic Critic Implementation</a></li><li><a href=#3-novelty-parsimony-critic-implementation>3. Novelty-Parsimony Critic Implementation</a></li></ul></li></ul></nav></nav></aside><div class=article-content><div class=guide-header><a href=/ class=home-link>‚Üê Back to GTCode.com Homepage</a></div><h1 id=chapter-3-multi-component-critic-pipeline>Chapter 3: Multi-Component Critic Pipeline</h1><h2 id=the-problem-with-black-box-evaluation>The Problem with Black-Box Evaluation</h2><p>Traditional knowledge synthesis systems often rely on opaque &ldquo;oracle&rdquo; critics that provide scores without explanation. CNS 2.0 takes a fundamentally different approach by decomposing evaluation into transparent, specialized components that each assess distinct aspects of narrative quality.</p><p>The Multi-Component Critic Pipeline consists of three specialized critics:</p><ol><li><strong>Grounding Critic</strong> - Evaluates evidential support</li><li><strong>Logic Critic</strong> - Assesses structural coherence</li><li><strong>Novelty-Parsimony Critic</strong> - Balances innovation against complexity</li></ol><h3 id=from-paper-to-code-the-mathematical-foundation>From Paper to Code: The Mathematical Foundation</h3><p>The power of this pipeline comes from its transparent, component-based approach to calculating a final reward or trust score. The paper formalizes this in Section 2.2 with Equation (1).</p><blockquote><p><strong>From the Paper (Equation 1):</strong>
The final trust score $T$ and reward signal emerge from a weighted combination:</p></blockquote>$$
\text{Reward}(\mathcal{S}) = \sum_{i \in \{G, L, N\}} w_i \cdot \text{Score}_i(\mathcal{S})
$$<blockquote><p>where $w_i$ are dynamically adjustable weights and the component scores are from the Grounding, Logic, and Novelty-Parsimony critics.</p></blockquote><p><strong>From Paper to Code:</strong></p><p>Our <code>CriticPipeline</code> class directly implements this weighted summation. Look at the <code>evaluate_sno</code> method:</p><div class=highlight><div style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">10
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#007f7f># From CriticPipeline.evaluate_sno</span>
</span></span><span style=display:flex><span>total_weighted_score = <span style=color:#ff0;font-weight:700>0.0</span>
</span></span><span style=display:flex><span>total_weight = <span style=color:#ff0;font-weight:700>0.0</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#fff;font-weight:700>for</span> critic_type, critic in <span style=color:#fff;font-weight:700>self</span>.critics.items():
</span></span><span style=display:flex><span>    result = critic.evaluate(sno, context)
</span></span><span style=display:flex><span>    total_weighted_score += result.score * critic.weight
</span></span><span style=display:flex><span>    total_weight += critic.weight
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>trust_score = total_weighted_score / total_weight <span style=color:#fff;font-weight:700>if</span> total_weight &gt; <span style=color:#ff0;font-weight:700>0</span> <span style=color:#fff;font-weight:700>else</span> <span style=color:#ff0;font-weight:700>0.0</span>
</span></span></code></pre></td></tr></table></div></div><p>Here&rsquo;s the breakdown:</p><ul><li>The <code>for</code> loop iterates through each critic, which represents the summation ($\sum$).</li><li><code>result.score</code> is the $\text{Score}_i(\mathcal{S})$ for a specific critic (Grounding, Logic, or Novelty).</li><li><code>critic.weight</code> is the $w_i$ for that critic.</li><li><code>total_weighted_score</code> accumulates the <code>result.score * critic.weight</code> product for each critic.</li><li>Finally, we divide by <code>total_weight</code> to normalize the score, which becomes the SNO&rsquo;s final <code>trust_score</code> (<code>T</code>).</li></ul><p>The <code>adjust_weights</code> method allows for the dynamic adjustment of $w_i$ values, just as described in the paper.</p><h2 id=implementing-the-specialized-critics>Implementing the Specialized Critics</h2><div class=highlight><div style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">  1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">  2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">  3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">  4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">  5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">  6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">  7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">  8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">  9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 49
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 50
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 51
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 52
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 53
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 54
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 55
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 56
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 57
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 58
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 59
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 60
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 61
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 62
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 63
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 64
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 65
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 66
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 67
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 68
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 69
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 70
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 71
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 72
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 73
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 74
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 75
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 76
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 77
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 78
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 79
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 80
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 81
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 82
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 83
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 84
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 85
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 86
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 87
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 88
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 89
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 90
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 91
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 92
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 93
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 94
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 95
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 96
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 97
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 98
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 99
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">100
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">101
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">102
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">103
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">104
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">105
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">106
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">107
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">108
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">109
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">110
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">111
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">112
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">113
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">114
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">115
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">116
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">117
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">118
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">119
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">120
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">121
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">122
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">123
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">124
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">125
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">126
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">127
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">128
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">129
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">130
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">131
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">132
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">133
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">134
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">135
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">136
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">137
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">138
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">139
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">140
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">141
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">142
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">143
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">144
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">145
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">146
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">147
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">148
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">149
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">150
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">151
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">152
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">153
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">154
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">155
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">156
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">157
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">158
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">159
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">160
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">161
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">162
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">163
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">164
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">165
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">166
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">167
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">168
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">169
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">170
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">171
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">172
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">173
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">174
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">175
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">176
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">177
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">178
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">179
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#0ff;font-weight:700>&#34;&#34;&#34;
</span></span></span><span style=display:flex><span><span style=color:#0ff;font-weight:700>Multi-Component Critic Pipeline Implementation
</span></span></span><span style=display:flex><span><span style=color:#0ff;font-weight:700>============================================
</span></span></span><span style=display:flex><span><span style=color:#0ff;font-weight:700>Transparent, auditable evaluation of SNO quality
</span></span></span><span style=display:flex><span><span style=color:#0ff;font-weight:700>&#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#fff;font-weight:700>from</span> abc <span style=color:#fff;font-weight:700>import</span> ABC, abstractmethod
</span></span><span style=display:flex><span><span style=color:#fff;font-weight:700>from</span> typing <span style=color:#fff;font-weight:700>import</span> Dict, List, Tuple, Optional, Any
</span></span><span style=display:flex><span><span style=color:#fff;font-weight:700>import</span> numpy <span style=color:#fff;font-weight:700>as</span> np
</span></span><span style=display:flex><span><span style=color:#fff;font-weight:700>from</span> dataclasses <span style=color:#fff;font-weight:700>import</span> dataclass
</span></span><span style=display:flex><span><span style=color:#fff;font-weight:700>from</span> enum <span style=color:#fff;font-weight:700>import</span> Enum
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>@dataclass
</span></span><span style=display:flex><span><span style=color:#fff;font-weight:700>class</span> CriticResult:
</span></span><span style=display:flex><span>    <span style=color:#0ff;font-weight:700>&#34;&#34;&#34;Result from a critic evaluation with full transparency&#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>    score: <span style=color:#fff;font-weight:700>float</span>  <span style=color:#007f7f># Normalized score [0, 1]</span>
</span></span><span style=display:flex><span>    confidence: <span style=color:#fff;font-weight:700>float</span>  <span style=color:#007f7f># Confidence in the assessment [0, 1]</span>
</span></span><span style=display:flex><span>    explanation: <span style=color:#fff;font-weight:700>str</span>  <span style=color:#007f7f># Human-readable explanation</span>
</span></span><span style=display:flex><span>    evidence: Dict[<span style=color:#fff;font-weight:700>str</span>, Any]  <span style=color:#007f7f># Supporting evidence for the score</span>
</span></span><span style=display:flex><span>    sub_scores: Dict[<span style=color:#fff;font-weight:700>str</span>, <span style=color:#fff;font-weight:700>float</span>]  <span style=color:#007f7f># Breakdown of component scores</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#fff;font-weight:700>class</span> CriticType(Enum):
</span></span><span style=display:flex><span>    GROUNDING = <span style=color:#0ff;font-weight:700>&#34;grounding&#34;</span>
</span></span><span style=display:flex><span>    LOGIC = <span style=color:#0ff;font-weight:700>&#34;logic&#34;</span>
</span></span><span style=display:flex><span>    NOVELTY = <span style=color:#0ff;font-weight:700>&#34;novelty&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#fff;font-weight:700>class</span> BaseCritic(ABC):
</span></span><span style=display:flex><span>    <span style=color:#0ff;font-weight:700>&#34;&#34;&#34;Abstract base class for all CNS 2.0 critics&#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#fff;font-weight:700>def</span> __init__(<span style=color:#fff;font-weight:700>self</span>, critic_type: CriticType, weight: <span style=color:#fff;font-weight:700>float</span> = <span style=color:#ff0;font-weight:700>1.0</span>):
</span></span><span style=display:flex><span>        <span style=color:#fff;font-weight:700>self</span>.critic_type = critic_type
</span></span><span style=display:flex><span>        <span style=color:#fff;font-weight:700>self</span>.weight = weight
</span></span><span style=display:flex><span>        <span style=color:#fff;font-weight:700>self</span>.evaluation_count = <span style=color:#ff0;font-weight:700>0</span>
</span></span><span style=display:flex><span>        <span style=color:#fff;font-weight:700>self</span>.performance_history = []
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    @abstractmethod
</span></span><span style=display:flex><span>    <span style=color:#fff;font-weight:700>def</span> evaluate(<span style=color:#fff;font-weight:700>self</span>, sno: StructuredNarrativeObject, context: Optional[Dict] = <span style=color:#fff;font-weight:700>None</span>) -&gt; CriticResult:
</span></span><span style=display:flex><span>        <span style=color:#0ff;font-weight:700>&#34;&#34;&#34;Evaluate an SNO and return detailed results&#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#fff;font-weight:700>pass</span>
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#fff;font-weight:700>def</span> update_weight(<span style=color:#fff;font-weight:700>self</span>, new_weight: <span style=color:#fff;font-weight:700>float</span>):
</span></span><span style=display:flex><span>        <span style=color:#0ff;font-weight:700>&#34;&#34;&#34;Dynamically adjust critic weight based on context&#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#fff;font-weight:700>self</span>.weight = new_weight
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#fff;font-weight:700>def</span> get_statistics(<span style=color:#fff;font-weight:700>self</span>) -&gt; Dict[<span style=color:#fff;font-weight:700>str</span>, Any]:
</span></span><span style=display:flex><span>        <span style=color:#0ff;font-weight:700>&#34;&#34;&#34;Get performance statistics for this critic&#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#fff;font-weight:700>return</span> {
</span></span><span style=display:flex><span>            <span style=color:#0ff;font-weight:700>&#39;type&#39;</span>: <span style=color:#fff;font-weight:700>self</span>.critic_type.value,
</span></span><span style=display:flex><span>            <span style=color:#0ff;font-weight:700>&#39;weight&#39;</span>: <span style=color:#fff;font-weight:700>self</span>.weight,
</span></span><span style=display:flex><span>            <span style=color:#0ff;font-weight:700>&#39;evaluations&#39;</span>: <span style=color:#fff;font-weight:700>self</span>.evaluation_count,
</span></span><span style=display:flex><span>            <span style=color:#0ff;font-weight:700>&#39;avg_score&#39;</span>: np.mean([r[<span style=color:#0ff;font-weight:700>&#39;score&#39;</span>] <span style=color:#fff;font-weight:700>for</span> r in <span style=color:#fff;font-weight:700>self</span>.performance_history]) <span style=color:#fff;font-weight:700>if</span> <span style=color:#fff;font-weight:700>self</span>.performance_history <span style=color:#fff;font-weight:700>else</span> <span style=color:#ff0;font-weight:700>0.0</span>,
</span></span><span style=display:flex><span>            <span style=color:#0ff;font-weight:700>&#39;avg_confidence&#39;</span>: np.mean([r[<span style=color:#0ff;font-weight:700>&#39;confidence&#39;</span>] <span style=color:#fff;font-weight:700>for</span> r in <span style=color:#fff;font-weight:700>self</span>.performance_history]) <span style=color:#fff;font-weight:700>if</span> <span style=color:#fff;font-weight:700>self</span>.performance_history <span style=color:#fff;font-weight:700>else</span> <span style=color:#ff0;font-weight:700>0.0</span>
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#fff;font-weight:700>class</span> CriticPipeline:
</span></span><span style=display:flex><span>    <span style=color:#0ff;font-weight:700>&#34;&#34;&#34;Orchestrates multiple critics to produce comprehensive SNO evaluation&#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#fff;font-weight:700>def</span> __init__(<span style=color:#fff;font-weight:700>self</span>):
</span></span><span style=display:flex><span>        <span style=color:#fff;font-weight:700>self</span>.critics: Dict[CriticType, BaseCritic] = {}
</span></span><span style=display:flex><span>        <span style=color:#fff;font-weight:700>self</span>.evaluation_history = []
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#fff;font-weight:700>def</span> add_critic(<span style=color:#fff;font-weight:700>self</span>, critic: BaseCritic):
</span></span><span style=display:flex><span>        <span style=color:#0ff;font-weight:700>&#34;&#34;&#34;Add a critic to the pipeline&#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#fff;font-weight:700>self</span>.critics[critic.critic_type] = critic
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#fff;font-weight:700>def</span> evaluate_sno(<span style=color:#fff;font-weight:700>self</span>, sno: StructuredNarrativeObject, context: Optional[Dict] = <span style=color:#fff;font-weight:700>None</span>) -&gt; Dict[<span style=color:#fff;font-weight:700>str</span>, Any]:
</span></span><span style=display:flex><span>        <span style=color:#0ff;font-weight:700>&#34;&#34;&#34;Evaluate an SNO using all available critics&#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>        results = {}
</span></span><span style=display:flex><span>        total_weighted_score = <span style=color:#ff0;font-weight:700>0.0</span>
</span></span><span style=display:flex><span>        total_weight = <span style=color:#ff0;font-weight:700>0.0</span>
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#fff;font-weight:700>for</span> critic_type, critic in <span style=color:#fff;font-weight:700>self</span>.critics.items():
</span></span><span style=display:flex><span>            result = critic.evaluate(sno, context)
</span></span><span style=display:flex><span>            results[critic_type.value] = result
</span></span><span style=display:flex><span>            
</span></span><span style=display:flex><span>            <span style=color:#007f7f># Accumulate weighted score</span>
</span></span><span style=display:flex><span>            total_weighted_score += result.score * critic.weight
</span></span><span style=display:flex><span>            total_weight += critic.weight
</span></span><span style=display:flex><span>            
</span></span><span style=display:flex><span>            <span style=color:#007f7f># Update critic performance history</span>
</span></span><span style=display:flex><span>            critic.performance_history.append({
</span></span><span style=display:flex><span>                <span style=color:#0ff;font-weight:700>&#39;score&#39;</span>: result.score,
</span></span><span style=display:flex><span>                <span style=color:#0ff;font-weight:700>&#39;confidence&#39;</span>: result.confidence
</span></span><span style=display:flex><span>            })
</span></span><span style=display:flex><span>            critic.evaluation_count += <span style=color:#ff0;font-weight:700>1</span>
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#007f7f># Compute final trust score</span>
</span></span><span style=display:flex><span>        trust_score = total_weighted_score / total_weight <span style=color:#fff;font-weight:700>if</span> total_weight &gt; <span style=color:#ff0;font-weight:700>0</span> <span style=color:#fff;font-weight:700>else</span> <span style=color:#ff0;font-weight:700>0.0</span>
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#007f7f># Update SNO trust score</span>
</span></span><span style=display:flex><span>        sno.trust_score = trust_score
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        evaluation_result = {
</span></span><span style=display:flex><span>            <span style=color:#0ff;font-weight:700>&#39;trust_score&#39;</span>: trust_score,
</span></span><span style=display:flex><span>            <span style=color:#0ff;font-weight:700>&#39;critic_results&#39;</span>: results,
</span></span><span style=display:flex><span>            <span style=color:#0ff;font-weight:700>&#39;weights_used&#39;</span>: {ct.value: c.weight <span style=color:#fff;font-weight:700>for</span> ct, c in <span style=color:#fff;font-weight:700>self</span>.critics.items()},
</span></span><span style=display:flex><span>            <span style=color:#0ff;font-weight:700>&#39;evaluation_id&#39;</span>: <span style=color:#fff;font-weight:700>len</span>(<span style=color:#fff;font-weight:700>self</span>.evaluation_history)
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#fff;font-weight:700>self</span>.evaluation_history.append(evaluation_result)
</span></span><span style=display:flex><span>        <span style=color:#fff;font-weight:700>return</span> evaluation_result
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#fff;font-weight:700>def</span> adjust_weights(<span style=color:#fff;font-weight:700>self</span>, weight_updates: Dict[CriticType, <span style=color:#fff;font-weight:700>float</span>]):
</span></span><span style=display:flex><span>        <span style=color:#0ff;font-weight:700>&#34;&#34;&#34;Dynamically adjust critic weights based on context&#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#fff;font-weight:700>for</span> critic_type, new_weight in weight_updates.items():
</span></span><span style=display:flex><span>            <span style=color:#fff;font-weight:700>if</span> critic_type in <span style=color:#fff;font-weight:700>self</span>.critics:
</span></span><span style=display:flex><span>                <span style=color:#fff;font-weight:700>self</span>.critics[critic_type].update_weight(new_weight)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#007f7f>### 1. Grounding Critic Implementation</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>&gt; **From Paper to Code: The Grounding Critic**
</span></span><span style=display:flex><span>&gt; The Grounding Critic evaluates how well a narrative<span style=color:#0ff;font-weight:700>&#39;s claims are supported by its evidence. Section 2.2 provides its formula:</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:red>$$</span>
</span></span><span style=display:flex><span>\text{Score}_G = \frac{<span style=color:#ff0;font-weight:700>1</span>}{|V|}\sum_{v \in V} \max_{e \in \mathcal{E}} p(v|e)
</span></span><span style=display:flex><span><span style=color:red>$$</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>&gt; Here, <span style=color:red>$</span>p(v|e)<span style=color:red>$</span> is the plausibility score of a claim <span style=color:red>`</span>v<span style=color:red>`</span> given a piece of evidence <span style=color:red>`</span>e<span style=color:red>`</span>. We will implement this using a pre-trained Natural Language Inference (NLI) model. An NLI model takes a premise (evidence) and a hypothesis (claim) and outputs probabilities <span style=color:#fff;font-weight:700>for</span> <span style=color:#0ff;font-weight:700>&#34;entailment,&#34;</span> <span style=color:#0ff;font-weight:700>&#34;neutral,&#34;</span> and <span style=color:#0ff;font-weight:700>&#34;contradiction.&#34;</span> We will use the <span style=color:#0ff;font-weight:700>&#34;entailment&#34;</span> probability <span style=color:#fff;font-weight:700>as</span> our <span style=color:red>$</span>p(v|e)<span style=color:red>$</span>.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:red>```</span>python
</span></span><span style=display:flex><span><span style=color:#fff;font-weight:700>class</span> GroundingCritic(BaseCritic):
</span></span><span style=display:flex><span>    <span style=color:#fff;font-weight:700>def</span> __init__(<span style=color:#fff;font-weight:700>self</span>, weight: <span style=color:#fff;font-weight:700>float</span>, nli_model=<span style=color:#fff;font-weight:700>None</span>, nli_tokenizer=<span style=color:#fff;font-weight:700>None</span>, nli_model_name: <span style=color:#fff;font-weight:700>str</span> = <span style=color:#0ff;font-weight:700>&#34;microsoft/deberta-large-mnli&#34;</span>):
</span></span><span style=display:flex><span>        <span style=color:#fff;font-weight:700>super</span>().__init__(CriticType.GROUNDING, weight)
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#007f7f># Use pre-loaded models if provided (for efficiency), otherwise load on demand</span>
</span></span><span style=display:flex><span>        <span style=color:#fff;font-weight:700>if</span> nli_model is not <span style=color:#fff;font-weight:700>None</span> and nli_tokenizer is not <span style=color:#fff;font-weight:700>None</span>:
</span></span><span style=display:flex><span>            <span style=color:#fff;font-weight:700>self</span>.nli_model = nli_model
</span></span><span style=display:flex><span>            <span style=color:#fff;font-weight:700>self</span>.nli_tokenizer = nli_tokenizer
</span></span><span style=display:flex><span>        <span style=color:#fff;font-weight:700>elif</span> HAS_TRANSFORMERS:
</span></span><span style=display:flex><span>            <span style=color:#fff;font-weight:700>import</span> transformers
</span></span><span style=display:flex><span>            <span style=color:#fff;font-weight:700>self</span>.nli_tokenizer = transformers.AutoTokenizer.from_pretrained(nli_model_name)
</span></span><span style=display:flex><span>            <span style=color:#fff;font-weight:700>self</span>.nli_model = transformers.AutoModelForSequenceClassification.from_pretrained(nli_model_name)
</span></span><span style=display:flex><span>        <span style=color:#fff;font-weight:700>else</span>:
</span></span><span style=display:flex><span>            <span style=color:#fff;font-weight:700>raise</span> ImportError(<span style=color:#0ff;font-weight:700>&#34;Transformers library is required for the GroundingCritic.&#34;</span>)
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#007f7f># Ensure we know the index for entailment</span>
</span></span><span style=display:flex><span>        <span style=color:#fff;font-weight:700>self</span>.entailment_id = <span style=color:#fff;font-weight:700>self</span>.nli_model.config.label2id.get(<span style=color:#0ff;font-weight:700>&#39;entailment&#39;</span>, <span style=color:#ff0;font-weight:700>2</span>)  <span style=color:#007f7f># Default to 2 if not found</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#fff;font-weight:700>def</span> evaluate(<span style=color:#fff;font-weight:700>self</span>, sno: StructuredNarrativeObject, context: Optional[Dict] = <span style=color:#fff;font-weight:700>None</span>) -&gt; CriticResult:
</span></span><span style=display:flex><span>        claims = [data[<span style=color:#0ff;font-weight:700>&#39;claim&#39;</span>] <span style=color:#fff;font-weight:700>for</span> _, data in sno.reasoning_graph.nodes(data=<span style=color:#fff;font-weight:700>True</span>)]
</span></span><span style=display:flex><span>        evidence_contents = [item.content <span style=color:#fff;font-weight:700>for</span> item in sno.evidence_set]
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#fff;font-weight:700>if</span> not claims or not evidence_contents:
</span></span><span style=display:flex><span>            <span style=color:#fff;font-weight:700>return</span> CriticResult(<span style=color:#ff0;font-weight:700>0.0</span>, <span style=color:#ff0;font-weight:700>1.0</span>, <span style=color:#0ff;font-weight:700>&#34;No claims or evidence to ground.&#34;</span>, {}, {})
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        total_max_plausibility = <span style=color:#ff0;font-weight:700>0.0</span>
</span></span><span style=display:flex><span>        sub_scores = {}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#fff;font-weight:700>for</span> claim in claims:
</span></span><span style=display:flex><span>            max_plausibility_for_claim = <span style=color:#ff0;font-weight:700>0.0</span>
</span></span><span style=display:flex><span>            
</span></span><span style=display:flex><span>            <span style=color:#007f7f># Prepare NLI model inputs</span>
</span></span><span style=display:flex><span>            pairs = [(e, claim.content) <span style=color:#fff;font-weight:700>for</span> e in evidence_contents]
</span></span><span style=display:flex><span>            inputs = <span style=color:#fff;font-weight:700>self</span>.nli_tokenizer(pairs, return_tensors=<span style=color:#0ff;font-weight:700>&#39;pt&#39;</span>, padding=<span style=color:#fff;font-weight:700>True</span>, truncation=<span style=color:#fff;font-weight:700>True</span>)
</span></span><span style=display:flex><span>            
</span></span><span style=display:flex><span>            <span style=color:#fff;font-weight:700>with</span> torch.no_grad():
</span></span><span style=display:flex><span>                logits = <span style=color:#fff;font-weight:700>self</span>.nli_model(**inputs).logits
</span></span><span style=display:flex><span>                
</span></span><span style=display:flex><span>            <span style=color:#007f7f># Get probabilities for entailment</span>
</span></span><span style=display:flex><span>            <span style=color:#007f7f># We use softmax to convert logits to probabilities</span>
</span></span><span style=display:flex><span>            probabilities = torch.softmax(logits, dim=<span style=color:#ff0;font-weight:700>1</span>)
</span></span><span style=display:flex><span>            entailment_probs = probabilities[:, <span style=color:#fff;font-weight:700>self</span>.entailment_id].tolist()
</span></span><span style=display:flex><span>            
</span></span><span style=display:flex><span>            <span style=color:#fff;font-weight:700>if</span> entailment_probs:
</span></span><span style=display:flex><span>                max_plausibility_for_claim = <span style=color:#fff;font-weight:700>max</span>(entailment_probs)
</span></span><span style=display:flex><span>            
</span></span><span style=display:flex><span>            total_max_plausibility += max_plausibility_for_claim
</span></span><span style=display:flex><span>            sub_scores[claim.claim_id] = max_plausibility_for_claim
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#007f7f># Score is the average of the max plausibility scores for each claim</span>
</span></span><span style=display:flex><span>        final_score = total_max_plausibility / <span style=color:#fff;font-weight:700>len</span>(claims) <span style=color:#fff;font-weight:700>if</span> claims <span style=color:#fff;font-weight:700>else</span> <span style=color:#ff0;font-weight:700>0.0</span>
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#fff;font-weight:700>return</span> CriticResult(
</span></span><span style=display:flex><span>            score=final_score,
</span></span><span style=display:flex><span>            confidence=<span style=color:#ff0;font-weight:700>0.8</span>, <span style=color:#007f7f># Confidence can be improved with model-specific metrics</span>
</span></span><span style=display:flex><span>            explanation=<span style=color:#0ff;font-weight:700>f</span><span style=color:#0ff;font-weight:700>&#34;Average max NLI entailment score across </span><span style=color:#0ff;font-weight:700>{</span><span style=color:#fff;font-weight:700>len</span>(claims)<span style=color:#0ff;font-weight:700>}</span><span style=color:#0ff;font-weight:700> claims is </span><span style=color:#0ff;font-weight:700>{</span>final_score<span style=color:#0ff;font-weight:700>:</span><span style=color:#0ff;font-weight:700>.3f</span><span style=color:#0ff;font-weight:700>}</span><span style=color:#0ff;font-weight:700>.&#34;</span>,
</span></span><span style=display:flex><span>            evidence={<span style=color:#0ff;font-weight:700>&#39;claim_scores&#39;</span>: sub_scores},
</span></span><span style=display:flex><span>            sub_scores=sub_scores
</span></span><span style=display:flex><span>        )
</span></span></code></pre></td></tr></table></div></div><h3 id=2-logic-critic-implementation>2. Logic Critic Implementation</h3><blockquote><p><strong>From Paper to Code: The Logic Critic</strong>
The Logic Critic assesses the structural coherence of the reasoning graph $G$. The paper specifies this as:</p></blockquote>$$
\text{Score}_L = f_{\text{GNN}}(G; \theta)
$$<blockquote><p>Training a full Graph Neural Network (GNN) is a research project in itself. For our primitive, we will create a <em>functional proxy</em> for $f_{\text{GNN}}$ that uses graph-theoretic features to approximate logical coherence. This is a robust, explainable starting point for future GNN development. We&rsquo;ll check for orphaned claims, excessive branching (unfocused arguments), and graph density.</p></blockquote><div class=highlight><div style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">43
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#fff;font-weight:700>class</span> LogicCritic(BaseCritic):
</span></span><span style=display:flex><span>    <span style=color:#fff;font-weight:700>def</span> __init__(<span style=color:#fff;font-weight:700>self</span>, weight: <span style=color:#fff;font-weight:700>float</span>):
</span></span><span style=display:flex><span>        <span style=color:#fff;font-weight:700>super</span>().__init__(CriticType.LOGIC, weight)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#fff;font-weight:700>def</span> evaluate(<span style=color:#fff;font-weight:700>self</span>, sno: StructuredNarrativeObject, context: Optional[Dict] = <span style=color:#fff;font-weight:700>None</span>) -&gt; CriticResult:
</span></span><span style=display:flex><span>        G = sno.reasoning_graph
</span></span><span style=display:flex><span>        num_nodes = G.number_of_nodes()
</span></span><span style=display:flex><span>        <span style=color:#fff;font-weight:700>if</span> num_nodes &lt;= <span style=color:#ff0;font-weight:700>1</span>:
</span></span><span style=display:flex><span>            <span style=color:#fff;font-weight:700>return</span> CriticResult(<span style=color:#ff0;font-weight:700>1.0</span>, <span style=color:#ff0;font-weight:700>1.0</span>, <span style=color:#0ff;font-weight:700>&#34;Graph is too simple to assess logic.&#34;</span>, {}, {})
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#007f7f># 1. Orphaned claims score (we want 0 orphans)</span>
</span></span><span style=display:flex><span>        <span style=color:#007f7f># Nodes with in-degree 0 (excluding the root) are orphans</span>
</span></span><span style=display:flex><span>        orphaned_nodes = [n <span style=color:#fff;font-weight:700>for</span> n, d in G.in_degree() <span style=color:#fff;font-weight:700>if</span> d == <span style=color:#ff0;font-weight:700>0</span> and n != <span style=color:#0ff;font-weight:700>&#39;root&#39;</span>]
</span></span><span style=display:flex><span>        orphan_penalty = <span style=color:#fff;font-weight:700>len</span>(orphaned_nodes) / (num_nodes - <span style=color:#ff0;font-weight:700>1</span>)
</span></span><span style=display:flex><span>        orphan_score = <span style=color:#ff0;font-weight:700>1.0</span> - orphan_penalty
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#007f7f># 2. Coherence score (low branching is better)</span>
</span></span><span style=display:flex><span>        <span style=color:#007f7f># Average out-degree measures branching. Lower is more focused.</span>
</span></span><span style=display:flex><span>        avg_out_degree = <span style=color:#fff;font-weight:700>sum</span>(d <span style=color:#fff;font-weight:700>for</span> _, d in G.out_degree()) / num_nodes
</span></span><span style=display:flex><span>        <span style=color:#007f7f># Normalize: assume max reasonable branching is ~3</span>
</span></span><span style=display:flex><span>        coherence_score = <span style=color:#fff;font-weight:700>max</span>(<span style=color:#ff0;font-weight:700>0</span>, <span style=color:#ff0;font-weight:700>1.0</span> - (avg_out_degree / <span style=color:#ff0;font-weight:700>3.0</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#007f7f># 3. Parsimony score (related to density)</span>
</span></span><span style=display:flex><span>        <span style=color:#007f7f># We prefer simpler, less dense graphs.</span>
</span></span><span style=display:flex><span>        density = nx.density(G)
</span></span><span style=display:flex><span>        parsimony_score = <span style=color:#ff0;font-weight:700>1.0</span> - density
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#007f7f># Combine scores</span>
</span></span><span style=display:flex><span>        final_score = <span style=color:#ff0;font-weight:700>0.5</span> * orphan_score + <span style=color:#ff0;font-weight:700>0.3</span> * coherence_score + <span style=color:#ff0;font-weight:700>0.2</span> * parsimony_score
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        sub_scores = {
</span></span><span style=display:flex><span>            <span style=color:#0ff;font-weight:700>&#39;orphan_score&#39;</span>: orphan_score,
</span></span><span style=display:flex><span>            <span style=color:#0ff;font-weight:700>&#39;coherence_score&#39;</span>: coherence_score,
</span></span><span style=display:flex><span>            <span style=color:#0ff;font-weight:700>&#39;parsimony_score&#39;</span>: parsimony_score
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#fff;font-weight:700>return</span> CriticResult(
</span></span><span style=display:flex><span>            score=final_score,
</span></span><span style=display:flex><span>            confidence=<span style=color:#ff0;font-weight:700>0.9</span>, <span style=color:#007f7f># High confidence as it&#39;s deterministic</span>
</span></span><span style=display:flex><span>            explanation=<span style=color:#0ff;font-weight:700>f</span><span style=color:#0ff;font-weight:700>&#34;Logic score based on graph structure: </span><span style=color:#0ff;font-weight:700>{</span>final_score<span style=color:#0ff;font-weight:700>:</span><span style=color:#0ff;font-weight:700>.3f</span><span style=color:#0ff;font-weight:700>}</span><span style=color:#0ff;font-weight:700>&#34;</span>,
</span></span><span style=display:flex><span>            evidence={<span style=color:#0ff;font-weight:700>&#39;num_orphans&#39;</span>: <span style=color:#fff;font-weight:700>len</span>(orphaned_nodes), <span style=color:#0ff;font-weight:700>&#39;avg_out_degree&#39;</span>: avg_out_degree, <span style=color:#0ff;font-weight:700>&#39;density&#39;</span>: density},
</span></span><span style=display:flex><span>            sub_scores=sub_scores
</span></span><span style=display:flex><span>        )
</span></span></code></pre></td></tr></table></div></div><h3 id=3-novelty-parsimony-critic-implementation>3. Novelty-Parsimony Critic Implementation</h3><blockquote><p><strong>From Paper to Code: The Novelty-Parsimony Critic</strong>
This critic balances innovation against complexity. The formula from Section 2.2 is:</p>$$
> \text{Score}_N = \alpha \cdot \min_i \|H - H_i\|_2 - \beta \cdot \frac{|E_G|}{|V|}
> $$<p>The formula uses subtraction to create this balance. The first term rewards novelty (Euclidean distance to the nearest neighbor in the SNO population), and the second term, scaled by Œ≤, penalizes graph complexity (edge-to-node ratio). Since the result is not inherently bounded in [0, 1], our code calculates the raw score and then clamps the result to fit within our scoring framework.</p></blockquote><div class=highlight><div style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">48
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#fff;font-weight:700>class</span> NoveltyParsimonyCritic(BaseCritic):
</span></span><span style=display:flex><span>    <span style=color:#fff;font-weight:700>def</span> __init__(<span style=color:#fff;font-weight:700>self</span>, weight: <span style=color:#fff;font-weight:700>float</span>, alpha: <span style=color:#fff;font-weight:700>float</span>, beta: <span style=color:#fff;font-weight:700>float</span>):
</span></span><span style=display:flex><span>        <span style=color:#fff;font-weight:700>super</span>().__init__(CriticType.NOVELTY, weight)
</span></span><span style=display:flex><span>        <span style=color:#fff;font-weight:700>self</span>.alpha = alpha
</span></span><span style=display:flex><span>        <span style=color:#fff;font-weight:700>self</span>.beta = beta
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#fff;font-weight:700>def</span> evaluate(<span style=color:#fff;font-weight:700>self</span>, sno: StructuredNarrativeObject, context: Optional[Dict] = <span style=color:#fff;font-weight:700>None</span>) -&gt; CriticResult:
</span></span><span style=display:flex><span>        sno_population = context.get(<span style=color:#0ff;font-weight:700>&#39;sno_population&#39;</span>, [])
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#007f7f># 1. Calculate Novelty Term: Œ± * min_i ||H - H_i||</span>
</span></span><span style=display:flex><span>        population_embeddings = [s.hypothesis_embedding <span style=color:#fff;font-weight:700>for</span> s in sno_population <span style=color:#fff;font-weight:700>if</span> s.sno_id != sno.sno_id and s.hypothesis_embedding is not <span style=color:#fff;font-weight:700>None</span>]
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#fff;font-weight:700>if</span> not population_embeddings or sno.hypothesis_embedding is <span style=color:#fff;font-weight:700>None</span>:
</span></span><span style=display:flex><span>            novelty_term = <span style=color:#fff;font-weight:700>self</span>.alpha * <span style=color:#ff0;font-weight:700>1.0</span> <span style=color:#007f7f># Max novelty if no population to compare to</span>
</span></span><span style=display:flex><span>            min_dist_str = <span style=color:#0ff;font-weight:700>&#34;N/A (first SNO)&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#fff;font-weight:700>else</span>:
</span></span><span style=display:flex><span>            distances = [np.linalg.norm(sno.hypothesis_embedding - h) <span style=color:#fff;font-weight:700>for</span> h in population_embeddings]
</span></span><span style=display:flex><span>            min_distance = <span style=color:#fff;font-weight:700>min</span>(distances)
</span></span><span style=display:flex><span>            <span style=color:#007f7f># Normalize distance (max L2 is 2.0) and multiply by alpha</span>
</span></span><span style=display:flex><span>            novelty_term = <span style=color:#fff;font-weight:700>self</span>.alpha * (min_distance / <span style=color:#ff0;font-weight:700>2.0</span>)
</span></span><span style=display:flex><span>            min_dist_str = <span style=color:#0ff;font-weight:700>f</span><span style=color:#0ff;font-weight:700>&#34;</span><span style=color:#0ff;font-weight:700>{</span>min_distance<span style=color:#0ff;font-weight:700>:</span><span style=color:#0ff;font-weight:700>.3f</span><span style=color:#0ff;font-weight:700>}</span><span style=color:#0ff;font-weight:700>&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#007f7f># 2. Calculate Parsimony Penalty Term: Œ≤ * (|E_G| / |V|)</span>
</span></span><span style=display:flex><span>        G = sno.reasoning_graph
</span></span><span style=display:flex><span>        num_nodes = G.number_of_nodes()
</span></span><span style=display:flex><span>        num_edges = G.number_of_edges()
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        complexity_ratio = <span style=color:#ff0;font-weight:700>0.0</span>
</span></span><span style=display:flex><span>        <span style=color:#fff;font-weight:700>if</span> num_nodes &gt; <span style=color:#ff0;font-weight:700>0</span>:
</span></span><span style=display:flex><span>            complexity_ratio = num_edges / num_nodes
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        parsimony_penalty = <span style=color:#fff;font-weight:700>self</span>.beta * complexity_ratio
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#007f7f># 3. Calculate Final Score according to the formula</span>
</span></span><span style=display:flex><span>        raw_score = novelty_term - parsimony_penalty
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#007f7f># Clamp the score to be within the [0, 1] range</span>
</span></span><span style=display:flex><span>        final_score = np.clip(raw_score, <span style=color:#ff0;font-weight:700>0</span>, <span style=color:#ff0;font-weight:700>1</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        explanation = <span style=color:#0ff;font-weight:700>f</span><span style=color:#0ff;font-weight:700>&#34;Score(</span><span style=color:#0ff;font-weight:700>{</span>final_score<span style=color:#0ff;font-weight:700>:</span><span style=color:#0ff;font-weight:700>.3f</span><span style=color:#0ff;font-weight:700>}</span><span style=color:#0ff;font-weight:700>) = NoveltyTerm(</span><span style=color:#0ff;font-weight:700>{</span>novelty_term<span style=color:#0ff;font-weight:700>:</span><span style=color:#0ff;font-weight:700>.3f</span><span style=color:#0ff;font-weight:700>}</span><span style=color:#0ff;font-weight:700>) - ParsimonyPenalty(</span><span style=color:#0ff;font-weight:700>{</span>parsimony_penalty<span style=color:#0ff;font-weight:700>:</span><span style=color:#0ff;font-weight:700>.3f</span><span style=color:#0ff;font-weight:700>}</span><span style=color:#0ff;font-weight:700>). Min dist: </span><span style=color:#0ff;font-weight:700>{</span>min_dist_str<span style=color:#0ff;font-weight:700>}</span><span style=color:#0ff;font-weight:700>.&#34;</span>
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#fff;font-weight:700>return</span> CriticResult(
</span></span><span style=display:flex><span>            score=final_score,
</span></span><span style=display:flex><span>            confidence=<span style=color:#ff0;font-weight:700>0.9</span>,
</span></span><span style=display:flex><span>            explanation=explanation,
</span></span><span style=display:flex><span>            evidence={<span style=color:#0ff;font-weight:700>&#39;novelty_term&#39;</span>: novelty_term, <span style=color:#0ff;font-weight:700>&#39;parsimony_penalty&#39;</span>: parsimony_penalty, <span style=color:#0ff;font-weight:700>&#39;complexity_ratio&#39;</span>: complexity_ratio},
</span></span><span style=display:flex><span>            sub_scores={<span style=color:#0ff;font-weight:700>&#39;novelty_term&#39;</span>: novelty_term, <span style=color:#0ff;font-weight:700>&#39;parsimony_penalty&#39;</span>: parsimony_penalty}
</span></span><span style=display:flex><span>        )
</span></span></code></pre></td></tr></table></div></div></div><nav class=article-nav><div class=nav-previous><a href=/guides/building-cns-2.0-developers-guide/chapter-4-synthesis-engine/ class="nav-link prev-link"><i data-feather=arrow-right></i><div class=nav-text><span class=nav-label>Next</span>
<span class=nav-title>Chapter 4: Generative Synthesis Engine</span></div></a></div><div class=nav-next><a href=/guides/building-cns-2.0-developers-guide/chapter-2-sno-foundations/ class="nav-link next-link"><div class=nav-text><span class=nav-label>Previous</span>
<span class=nav-title>Chapter 2: SNO Foundations</span></div><i data-feather=arrow-left></i></a></div></nav><aside class=chapter-summary><h3>Chapter Summary</h3><div class=summary-content><p>Implementing transparent evaluation through specialized critic components.</p><ul><li>Multi-component critic architecture</li><li>Grounding, Logic, and Novelty critics</li><li>Transparent scoring and evaluation</li></ul></div></aside></article></div></main><footer class=site-footer><div class=container><div class=footer-content><div class=footer-text><p>&copy; 2025 <a href=https://GTCode.com/ class=footer-link>GTCode.com</a>. Educational content for CNS 2.0 implementation.</p><p>Based on <a href=https://github.com/nshkrdotcom/research_papers/blob/main/ResearchProposal-ChiralNarrativeSynthesis_20250617.pdf class=footer-link>CNS 2.0: A Practical Blueprint for Chiral Narrative Synthesis</a> research paper.</p></div></div></div></footer></div><script src=/js/navigation.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/prism/1.24.1/components/prism-core.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/prism/1.24.1/plugins/autoloader/prism-autoloader.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/prism/1.24.1/plugins/line-numbers/prism-line-numbers.min.js></script><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.js></script><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/contrib/auto-render.min.js onload='renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1}]})'></script><script>window.feather&&feather.replace()</script></body></html>